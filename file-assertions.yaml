ud-ldap-server:
  files:
    - path: /etc/nsswitch.conf
      owner: root
      group: root
      mode: '644'
    - path: /etc/ssh/sshd_config
      owner: root
      group: root
      mode: '644'
    - path: /etc/ssh/user-authorized-keys/ubuntu
      owner: root
      group: root
      mode: '444'
    - path: /etc/sudoers.d/80-adm-sudoers
      owner: root
      group: root
      mode: '440'
    - path:  /usr/local/sbin/snafflekeys
      owner: root
      group: root
      mode: '755'
    - path:  /usr/local/sbin/rsync_userdata.py
      owner: root
      group: root
      mode: '755'
    - path:  /etc/cron.d/rsync_userdata
      owner: root
      group: root
      mode: '644'
    - path:  /root/.ssh
      owner: root
      group: root
      mode: '700'
    - path:  /root/.ssh/id_rsa
      owner: root
      group: root
      mode: '600'
    - path:  /root/.ssh/id_rsa.pub
      owner: root
      group: root
      mode: '644'
    - path:  /root/.ssh/known_hosts
      owner: root
      group: root
    - path: /etc/cron.d/ud-replicate
      owner: root
      group: root
      mode: '644'
    - path: /var/lib/misc/userkeys/foo
      owner: foo
      group: testgroup
      mode: '600'
    - path:  /var/cache/userdir-ldap/hosts
      owner: sshdist
      group: root
      mode: '755'
    - path: /var/lib/misc/server0.lxd/shadow.tdb
      owner: root
      group: root
      mode: '600'
    - path: /var/lib/misc/shadow.db
      owner: root
      group: shadow
      mode: '640'
    # The below are created after logging in from the ssh tests, by pam_mkhome
    - path: /home/foo
      owner: foo
      group: testgroup
      mode: '755'
    - path: /home/a.bc
      owner: a.bc
      group: testgroup
      mode: '755'

ud-ldap-client:
  files:
    - path: /etc/nsswitch.conf
      owner: root
      group: root
      mode: '644'
    - path: /etc/ssh/sshd_config
      owner: root
      group: root
      mode: '644'
    - path: /etc/ssh/user-authorized-keys/ubuntu
      owner: root
      group: root
      mode: '444'
    - path: /etc/sudoers.d/80-adm-sudoers
      owner: root
      group: root
      mode: '440'
    - path: /etc/sudoers.d/90-juju-userdir-ldap
      owner: root
      group: root
      mode: '440'
    - path:  /usr/local/sbin/snafflekeys
      owner: root
      group: root
      mode: '755'
    - path:  /root/.ssh
      owner: root
      group: root
      mode: '700'
    - path:  /root/.ssh/id_rsa
      owner: root
      group: root
      mode: '600'
    - path:  /root/.ssh/id_rsa.pub
      owner: root
      group: root
      mode: '644'
    - path:  /root/.ssh/known_hosts
      owner: root
      group: root
      mode: '600'
    - path: /etc/cron.d/ud-replicate
      owner: root
      group: root
      mode: '644'
    - path: /var/lib/misc/bootstack-template.internal/shadow.tdb
      owner: root
      group: root
      mode: '600'
    - path: /var/lib/misc/shadow.db
      owner: root
      group: shadow
      mode: '640'
    # The below are created after logging in from the ssh tests, by pam_mkhome
    - path: /home/foo
      owner: foo
      group: testgroup
      mode: '755'
    - path: /home/a.bc
      owner: a.bc
      group: testgroup
      mode: '755'
